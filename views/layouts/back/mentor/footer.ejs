<footer class="footer navbar-fixed-bottom navbar-static-bottom">
  <div class="row align-items-center justify-content-lg-between">
    <div class="col-lg-6">
      <div class="copyright text-center text-lg-left text-muted">
        &copy; 2020
        <a
          href="https://www.creative-tim.com"
          class="font-weight-bold ml-1"
          target="_blank"
          >expert-assist</a
        >
      </div>
    </div>
    <div class="col-lg-6">
      <ul class="nav nav-footer justify-content-center justify-content-lg-end">
        <li class="nav-item">
          <a
            href="https://www.creative-tim.com"
            class="nav-link"
            target="_blank"
            >expert-assist</a
          >
        </li>
        <li class="nav-item">
          <a
            href="https://www.creative-tim.com/presentation"
            class="nav-link"
            target="_blank"
            >About Us</a
          >
        </li>
        <li class="nav-item">
          <a
            href="http://blog.creative-tim.com"
            class="nav-link"
            target="_blank"
            >Blog</a
          >
        </li>
        <li class="nav-item">
          <a
            href="https://www.creative-tim.com/license"
            class="nav-link"
            target="_blank"
            >License</a
          >
        </li>
      </ul>
    </div>
  </div>
</footer>

<!-- Argon Scripts -->
<!-- Core -->
<script src="../../back/assets/vendor/jquery/dist/jquery.min.js"></script>
<script src="../../back/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
<script src="../../back/assets/vendor/js-cookie/js.cookie.js"></script>
<script src="../../back/assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js"></script>
<script src="../../back/assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js"></script>
<!-- Optional JS -->
<script src="../../back/assets/vendor/chart.js/dist/Chart.min.js"></script>
<script src="../../back/assets/vendor/chart.js/dist/Chart.extension.js"></script>
<script src="../../back/assets/vendor/jvectormap-next/jquery-jvectormap.min.js"></script>
<script src="../../back/assets/js/vendor/jvectormap/jquery-jvectormap-world-mill.js"></script>
<!-- Argon JS -->
<script src="../../back/assets/js/argon.js?v=1.1.0"></script>
<!-- Demo JS - remove this in your project -->
<script src="../../back/assets/js/demo.min.js"></script>
<!-- Countdown -->
<script src="../../back/assets/js/countdown.js"></script>
<!-- Rate Yo Star -->
<script src="../../back/assets/js/rater.js"></script>
<!-- JSPDF & Plugin -->
<script src="https://unpkg.com/jspdf@latest/dist/jspdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.3/jspdf.plugin.autotable.min.js"></script>
<!-- Data Table -->
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
<script type="text/javascript">
  function statusSubmit() {
    document.getElementById("statusform").submit();
  }
</script>
<!-- Trigerred Modals -->
<script>
  $(document).ready(function () {
    $("#modal-notification").modal("show");

    $("#mytable").DataTable({
      ordering: false,
      stateSave: true,
      pagingType: "simple_numbers",
      language: {
        paginate: {
          first: "«",
          previous: "‹",
          next: "›",
          last: "»",
        },
      },
      responsive: true,
    });

    let interval = 1000;

    function getRequest() {
      $.when(
        $.get({
          url: "/api/mentor/schedules",
        }),
        $.get({
          url: "/api/mentor/withdraws",
        }),
        $.get({
          url: "/api/mentor/payments",
        }),
        $.get({
          url: "/api/mentor/reviews",
        })
      )
        .then((data1, data2, data3, data4) => {
          let scheduleKey = "schedule_" + "<%-session.username%>";
          let withdrawKey = "withdraw_" + "<%-session.username%>";
          let paymentKey = "payment_" + "<%-session.username%>";
          let reviewKey = "review_" + "<%-session.username%>";

          let newData1 = JSON.stringify(data1[0].schedule);
          let newData2 = JSON.stringify(data2[0].withdraw);
          let newData3 = JSON.stringify(data3[0].total);
          let newData4 = JSON.stringify(data4[0].review);

          let oldData1 = localStorage.getItem(scheduleKey);
          let oldData2 = localStorage.getItem(withdrawKey);
          let oldData3 = localStorage.getItem(paymentKey);
          let oldData4 = localStorage.getItem(reviewKey);

          // console.log(`Schedule: ${oldData1} = ${newData1}`);
          // console.log(`Withdraw: ${oldData2} = ${newData2}`);
          // console.log(`Payment: ${oldData3} = ${newData3}`);
          // console.log(`Review: ${oldData4} = ${newData4}`);

          if (!oldData1) {
            localStorage.setItem(scheduleKey, newData1);
          } else if (!oldData2) {
            localStorage.setItem(withdrawKey, newData2);
          } else if (!oldData3) {
            localStorage.setItem(paymentKey, newData3);
          } else if (!oldData4) {
            localStorage.setItem(reviewKey, newData4);
          } else {
            if (newData1 > oldData1) {
              Swal.fire({
                title: "New Schedule Notification",
                width: 400,
                icon: "success",
                padding: "3em",
                backdrop: "rgba(0,0,123,0.4)",
                showConfirmButton: false,
                timer: 10000,
              });
              localStorage.removeItem(scheduleKey);
            } else if (newData2 > oldData2) {
              Swal.fire({
                title: "Withdraw Accepted Notification",
                width: 400,
                icon: "success",
                padding: "3em",
                backdrop: "rgba(0,0,123,0.4)",
                showConfirmButton: false,
                timer: 10000,
              });
              localStorage.removeItem(withdrawKey);
            } else if (newData3 > oldData3) {
              Swal.fire({
                title: "New Payment Notification",
                width: 400,
                icon: "success",
                padding: "3em",
                backdrop: "rgba(0,0,123,0.4)",
                showConfirmButton: false,
                timer: 10000,
              });
              localStorage.removeItem(paymentKey);
            } else if (newData4 > oldData4) {
              Swal.fire({
                title: "New Review Notification",
                width: 400,
                icon: "success",
                padding: "3em",
                backdrop: "rgba(0,0,123,0.4)",
                showConfirmButton: false,
                timer: 10000,
              });
              localStorage.removeItem(reviewKey);
            }
          }
        })
        .fail((err) => {
          console.log(err);
        })
        .always(function () {
          setTimeout(getRequest, interval);
        });
    }
    setTimeout(getRequest, interval);
  });
</script>
